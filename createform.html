<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="bimble.css">
    <script src="https://kit.fontawesome.com/yourcode.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="import" href="../polymer/polymer.html">
    <link rel="import" href="../google-apis/google-maps-api.html">
    <dom-module id="input-location">
    <title>Create Account</title>
    <style>
        .other-breed-input {
            display: none; /* Hide the input by default */
        }
        img {
            border: 2px solid black;
            width: 150px;
            height: 150px;
            border-radius: 50%; /* Make the image circular */
            object-fit: cover; /* Ensure the image covers the entire circle */
        }
    </style>
    <script>
        function toggleOtherBreedInput(selectElement) {
            const otherBreedInput = document.getElementById('other-breed-input');
            if (selectElement.value === 'Others') {
                otherBreedInput.style.display = 'block'; // Show input if "Others" is selected
            } else {
                otherBreedInput.style.display = 'none'; // Hide input otherwise
            }
        }
    </script>
</head>
<body>
    <div style="margin: 40px 80px 40px 80px;">
        <form class="container-fluid create-form-container" method="POST" action="home.html">
            <div style="padding: 20px;">
                <div style="display: flex; justify-content: center; align-items: center; flex-direction: column;">
                    <label class="custom-file-upload" style="padding-bottom: 20px; text-align: center;" for="pet-picture">
                        Choose your best pet picture! <i class="fa-solid fa-camera" style="font-size: large;"></i>
                        <div style="display: flex; justify-content: center; align-items: center;">
                            <img id="preview" src="" alt="" style="display: none;">
                        </div>
                        <input type="file" id="pet-picture" name="pet-picture" accept=".png, .jpg, .jpeg" onchange="displayImage(event)">
                    </label>
                </div>
                <br>
                <label for="petname">Name of Pet: </label>
                    <input type="text" id="petname" name="petname" required>
                <br><br>
                <label for="breed">Breed:</label>
                <select name="breed" required onchange="toggleOtherBreedInput(this)">
                    <option value="" style="color: gray;" disabled selected>Select a breed</option>
                    <option value="Labrador">Labrador</option>
                    <option value="German Shepherd">German Shepherd</option>
                    <option value="Golden Retriever">Golden Retriever</option>
                    <option value="Bulldog">Bulldog</option>
                    <option value="Beagle">Beagle</option>
                    <option value="Poodle">Poodle</option>
                    <option value="Rottweiler">Rottweiler</option>
                    <option value="Yorkshire Terrier">Yorkshire Terrier</option>
                    <option value="Dachshund">Dachshund</option>
                    <option value="Siberian Husky">Siberian Husky</option>
                    <option value="Others">Others</option> <!-- Added Others option -->
                </select>
                <div class="other-breed-input" id="other-breed-input">
                    <br>
                    <label>Specify Breed: </label>
                    <input type="text" name="other_breed">
                </div>
                <br><br>
                <label>Gender:</label>
                    <select name="sex" required>
                        <option value="" style="color: gray;" disabled selected>Select Gender</option>
                        <option value="male">Male</option>
                        <option value="female">Female</option>
                    </select>
                <br><br>
                <label>Birthday:</label><br>
                <input type="date" name="petname" required>
                <br><br>
                <label for="location">Location:</label><br>
                <input type="text" id="location" name="location" placeholder="Start typing your location..." autocomplete="off" required>
                <ul id="autocomplete-results" class="autocomplete-dropdown"></ul>
                <div style="text-align: center;">
                    <input type="submit" value="Submit" class="create-profile-btn">
                </div>
            </div>
        </form>
    </div>


    <script>
        function displayImage(event) {
            const file = event.target.files[0];
            const reader = new FileReader();

            reader.onload = function(e) {
                const img = document.getElementById('preview');
                img.src = e.target.result;
                img.style.display = 'block'; // Show the image
            }

            if (file) {
                reader.readAsDataURL(file); // Convert the file to a data URL
            }
        }

        let autocompleteService;
        let sessionToken;
        const resultsDropdown = document.getElementById('autocomplete-results');
        const locationInput = document.getElementById('location');

        // Initialize Google Maps API and Autocomplete Service
        function initializeAutocomplete() {
            // Create a new session token for each session
            sessionToken = new google.maps.places.AutocompleteSessionToken();
            autocompleteService = new google.maps.places.AutocompleteService();
        }

        // Handle input changes and fetch autocomplete results
        locationInput.addEventListener('input', () => {
            const query = locationInput.value.trim();

            if (query.length > 2) {
                autocompleteService.getPlacePredictions(
                    { input: query, sessionToken },
                    displayAutocompleteResults
                );
            } else {
                clearAutocompleteResults();
            }
        });

        // Display autocomplete results in the dropdown
        function displayAutocompleteResults(predictions, status) {
            clearAutocompleteResults();

            if (status === google.maps.places.PlacesServiceStatus.OK && predictions) {
                predictions.forEach((prediction) => {
                    const listItem = document.createElement('li');
                    listItem.textContent = prediction.description;
                    listItem.classList.add('autocomplete-item');
                    listItem.onclick = () => selectLocation(prediction.description);
                    resultsDropdown.appendChild(listItem);
                });
            }
        }

        // Handle selection of a location
        function selectLocation(selectedLocation) {
            locationInput.value = selectedLocation;
            clearAutocompleteResults();
        }

        // Clear dropdown results
        function clearAutocompleteResults() {
            resultsDropdown.innerHTML = '';
        }


    </script>

</body>
</html>